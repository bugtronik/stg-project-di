USE [sagex3]
GO

/****** Object:  View [SETPROD].[YDICAPEX]    Script Date: 13/02/2025 14:24:40 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

Create View [SETPROD].[YDICAPEX]  ( CCE_0 , LIB_0 , CUR_0 , DES_0 , ACCDAT_F_0 , STA_0 , ACCDAT_0 , CURLIN_0 
 , PAYLOCLIN_0 , CCE1_0 , BAN_0 , NUM_0 , BPSNUM_0 , BPRNAM_0 ) As 
SELECT CCE_0,
		LIB_0,
		F.CUR_0,
		DES_0,
		F.ACCDAT_0,
		STA_0,
		R.ACCDAT_0,
		R.CURLIN_0,
		PAYLOCLIN_0,
		CCE1_0,
		R.BAN_0,
                R.NUM_0,
               BPSNUM_0,
               R.BPRNAM_0
FROM SETPROD.XCDEFAC F
INNER JOIN SETPROD.XREGFAC R 
ON F.NUM_0=R.VRCNUM_0
WHERE R.ACCDAT_0 BETWEEN '2025-01-01' AND '2025-12-31' AND R.BAN_0 IN ('111C', '117C', '137C', '113C')  AND STA_0=9
 
UNION
 
SELECT CCE_0,
		LIB_0,
		F.CUR_0,
		DES_0,
		F.ACCDAT_0,
		STA_0,
		R.ACCDAT_0,
		R.CURLIN_0,
		PAYLOCLIN_0,
		CCE1_0,
		R.BAN_0,
                R.NUM_0,
                BPSNUM_0,
                R.BPRNAM_0
FROM SETPROD.XCDEFAC F
INNER JOIN SETPROD.XREGFAC R ON VCRNUM_0=R.VRCNUM_0
WHERE R.ACCDAT_0 BETWEEN '2025-01-01' AND '2025-12-31' AND R.BAN_0 IN ('111C', '117C', '137C', '113C')  AND STA_0=9

GO


